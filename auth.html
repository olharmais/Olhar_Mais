<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OlharMais - Login</title>
    <meta name="description" content="Sistema OlharMais - Plataforma de gerenciamento">
    <meta name="theme-color" content="#005ae2">
    
    
    <!-- PWA -->
    <meta name="theme-color" content="#005ae2">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="OlharMais">
    
    <!-- iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="OlharMais">
    
    <!-- Manifest e Icons -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/favicon/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicon/favicon.ico" sizes="any">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icons/icon-16x16.png">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://olharmais.com/">
    <meta property="og:title" content="OlharMais - Gestão Escolar e Segurança de Alunos">
    <meta property="og:description" content="Plataforma completa para transformar a maneira como você gerencia sua Escola. Gestão escolar e segurança de alunos em um só lugar.">
    <meta property="og:image" content="https://olharmais.com/metatag.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://olharmais.com/">
    <meta property="twitter:title" content="OlharMais - Gestão Escolar e Segurança de Alunos">
    <meta property="twitter:description" content="Plataforma completa para transformar a maneira como você gerencia sua Escola. Gestão escolar e segurança de alunos em um só lugar.">
    <meta property="twitter:image" content="https://olharmais.com/metatag.png">
    
    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons -->
    <script>
        // Carrega Phosphor Icons com modo no-cors para evitar erro CORS
        const loadPhosphorIcons = async () => {
            try {
                // Tenta o carregamento normal primeiro
                await import('https://unpkg.com/@phosphor-icons/web');
                console.log('Phosphor Icons carregado com sucesso');
            } catch (error) {
                console.warn('Tentando carregar Phosphor Icons em modo no-cors...');
                // Fallback: cria um link para o CSS com modo no-cors
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = 'https://unpkg.com/@phosphor-icons/web/styles.css';
                document.head.appendChild(link);
            }
        };
        loadPhosphorIcons();
    </script>
    
    <!-- PWA Register -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/service-worker.js', {
                        scope: '/'
                    });
                    console.log('ServiceWorker registrado com sucesso:', registration.scope);
                } catch (error) {
                    console.error('Falha ao registrar o ServiceWorker:', error);
                }
            });
        }

        // Adicionar ao homescreen
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });
    </script>
    
    <!-- Verificador de ícones -->
    <script src="/check-icons.js"></script>
    
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary': '#005ae2',
                        'primary-light': '#E6F0FF',
                        'primary-dark': '#004bc9',
                        'logo-blue': '#005ae2'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-out'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Funções globais para WhatsApp e Supabase -->
    <script type="module">
        import { getSupabaseCredentials, getWhatsappApiUrl, getWhatsappApiKey, createSupabaseClient } from './config/supabase.js';
        
        // Disponibiliza as funções globalmente
        window.getWhatsappApiUrl = getWhatsappApiUrl;
        window.getWhatsappApiKey = getWhatsappApiKey;
        window.createSupabaseClient = createSupabaseClient;
    </script>
    
    <style>
        body {
            background: linear-gradient(180deg, #E6F0FF 0%, #FFFFFF 100%);
            min-height: 100vh;
        }
        
        .logo-olharmais {
            background: linear-gradient(90deg, #005ae2 0%, #3988ff 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }
        }
    </style>
</head>
<body class="font-sans">
    <div class="container mx-auto px-4 py-8 max-w-md">
        <!-- Menu de suporte será inserido via JavaScript -->
        <div id="support-menu-container"></div>
        
        <div class="flex flex-col items-center justify-center min-h-[90vh]">
            <!-- Logo -->
            <h1 class="text-5xl font-extrabold logo-olharmais mb-6">OlharMais</h1>
            
            <!-- Cabeçalho -->
            <div class="text-center mb-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-2">Seja Bem-Vindo</h2>
                <p class="text-gray-600">Digite seu telefone para receber o código</p>
            </div>
            
            <!-- Formulário -->
            <div class="w-full">
                <!-- Abas -->
                <div class="flex mb-6 border-b border-gray-200">
                    <button id="login-tab" class="tab-active flex-1 py-3 font-medium text-center border-b-2 border-primary text-primary">Entrar</button>
                    <button id="register-tab" class="flex-1 py-3 font-medium text-center text-gray-500">Cadastrar</button>
                </div>
                
                <!-- Formulário de Login -->
                <div id="login-form" class="space-y-4">
                    <div class="relative">
                        <input type="tel" id="phone" placeholder="Telefone com DDD" required
                            class="w-full py-4 pl-12 pr-4 border border-gray-300 rounded-full focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none text-base transition-all">
                        <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                <path d="M231.88,175.08A56.26,56.26,0,0,1,176,224C96.6,224,32,159.4,32,80A56.26,56.26,0,0,1,80.92,24.12a16,16,0,0,1,16.62,9.52l21.12,47.15,0,.12a16,16,0,0,1-.28,14.84,16.2,16.2,0,0,1-3,3.88l-17.28,17.28a72.08,72.08,0,0,0,39.34,39.34l17.28-17.28a16.2,16.2,0,0,1,3.88-3,16,16,0,0,1,14.84-.28l.12,0,47.15,21.12a16,16,0,0,1,9.52,16.62Z"></path>
                            </svg>
                        </div>
                    </div>
                    
                    <button id="login-btn" type="submit" class="w-full h-[57px] bg-primary text-white rounded-full font-semibold text-lg hover:bg-primary-dark transition-colors flex items-center justify-center gap-2">
                        <span>Receber Código</span>
                        <div class="hidden">
                            <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </div>
                    </button>
                    
                    <!-- Campos do código de verificação (inicialmente ocultos) -->
                    <div id="login-verification-code" class="hidden">
                        <p class="text-center mb-3 text-gray-600">Digite o código recebido via WhatsApp:</p>
                        <div class="flex justify-between gap-2">
                            <input type="number" pattern="[0-9]*" inputmode="numeric" maxlength="1" class="login-code-input w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                            <input type="number" pattern="[0-9]*" inputmode="numeric" maxlength="1" class="login-code-input w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                            <input type="number" pattern="[0-9]*" inputmode="numeric" maxlength="1" class="login-code-input w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                            <input type="number" pattern="[0-9]*" inputmode="numeric" maxlength="1" class="login-code-input w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                            <input type="number" pattern="[0-9]*" inputmode="numeric" maxlength="1" class="login-code-input w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                            <input type="number" pattern="[0-9]*" inputmode="numeric" maxlength="1" class="login-code-input w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                        </div>
                        <button id="verify-login-code" class="w-full h-[57px] bg-primary text-white py-3 rounded-full font-semibold text-lg hover:bg-primary-dark transition-colors flex items-center justify-center gap-2 mt-4">
                            <span>Entrar</span>
                            <div class="hidden">
                                <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                            </div>
                        </button>
                    </div>
                </div>
                
                <!-- Formulário de Cadastro -->
                <div id="register-form" class="space-y-6 hidden">
                    <!-- Cards de Perfil -->
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="profile-card" data-type="GESTOR">
                            <div class="p-4 border rounded-xl hover:border-primary hover:bg-primary-light transition-all cursor-pointer flex flex-col items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#006AFF" viewBox="0 0 256 256">
                                    <path d="M244.8,150.4a8,8,0,0,1-11.2-1.6A51.6,51.6,0,0,0,192,128a8,8,0,0,1-7.37-4.89,8,8,0,0,1,0-6.22A8,8,0,0,1,192,112a24,24,0,1,0-23.24-30,8,8,0,1,1-15.5-4A40,40,0,1,1,219,117.51a67.94,67.94,0,0,1,27.43,21.68A8,8,0,0,1,244.8,150.4ZM190.92,212a8,8,0,1,1-13.84,8,57,57,0,0,0-98.16,0,8,8,0,1,1-13.84-8,72.06,72.06,0,0,1,33.74-29.92,48,48,0,1,1,58.36,0A72.06,72.06,0,0,1,190.92,212ZM128,176a32,32,0,1,0-32-32A32,32,0,0,0,128,176Z"></path>
                                </svg>
                                <span class="mt-2 font-medium">Gestor</span>
                            </div>
                        </div>
                        <div class="profile-card" data-type="NUTRICIONISTA">
                            <div class="p-4 border rounded-xl hover:border-primary hover:bg-primary-light transition-all cursor-pointer flex flex-col items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#006AFF" viewBox="0 0 256 256">
                                    <path d="M208,40H168a8,8,0,0,0-8,8v30.13A48.9,48.9,0,0,0,144,104a47.51,47.51,0,0,0,5.6,22.39,52.91,52.91,0,0,1-11.52,15l-32.42,28.32A16,16,0,0,1,84,176v32a8,8,0,0,0,8,8H216a8,8,0,0,0,8-8V48A8,8,0,0,0,216,40ZM104,176a28.77,28.77,0,0,0,8.42-6l32.43-28.33a68.68,68.68,0,0,0,15-19.41A47.76,47.76,0,0,0,192,104V48h16v88H107.59A67.93,67.93,0,0,1,104,176ZM177.13,180a76.4,76.4,0,0,1-16,20H151.72a59.79,59.79,0,0,0,25.41-20ZM32,104a32,32,0,1,1,32,32A32,32,0,0,1,32,104Z"></path>
                                </svg>
                                <span class="mt-2 font-medium">Nutricionista</span>
                            </div>
                        </div>
                        <div class="profile-card" data-type="PROFISSIONAL">
                            <div class="p-4 border rounded-xl hover:border-primary hover:bg-primary-light transition-all cursor-pointer flex flex-col items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#006AFF" viewBox="0 0 256 256">
                                    <path d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM40,56H216v32H40ZM216,200H40V104H216v96Zm-24-24a8,8,0,0,1-8,8H72a8,8,0,0,1,0-16H184A8,8,0,0,1,192,176Zm0-32a8,8,0,0,1-8,8H72a8,8,0,0,1,0-16H184A8,8,0,0,1,192,144Z"></path>
                                </svg>
                                <span class="mt-2 font-medium">Profissional</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Etapa WhatsApp -->
                    <div class="whatsapp-step hidden">
                        <div class="relative">
                            <input type="tel" id="register-phone" placeholder="WhatsApp com DDD" required
                                class="w-full py-4 pl-12 pr-4 border border-gray-300 rounded-full focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none text-base transition-all">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                    <path d="M187.58,144.84l-32-16a8,8,0,0,0-8,.5l-14.69,9.8a40.55,40.55,0,0,1-16-16l9.8-14.69a8,8,0,0,0,.5-8l-16-32A8,8,0,0,0,104,64a40,40,0,0,0-40,40,88.1,88.1,0,0,0,88,88,40,40,0,0,0,40-40A8,8,0,0,0,187.58,144.84Z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <button id="send-code" class="w-full h-[57px] mt-4 bg-primary text-white rounded-full font-medium hover:bg-primary-dark transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 active:transform active:scale-[0.99] flex items-center justify-center">
                            <span>Receber Código</span>
                        </button>
                        
                        <!-- Campo de Código -->
                        <div class="verification-code hidden mt-6">
                            <p class="text-center mb-3 text-gray-600">Digite o código recebido via WhatsApp:</p>
                            <div class="flex justify-between gap-2">
                                <input type="text" maxlength="1" class="w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                                <input type="text" maxlength="1" class="w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                                <input type="text" maxlength="1" class="w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                                <input type="text" maxlength="1" class="w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                                <input type="text" maxlength="1" class="w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                                <input type="text" maxlength="1" class="w-12 h-12 text-center text-2xl border-2 border-gray-400 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none shadow-sm">
                            </div>
                            <button id="verify-code" class="w-full h-12 bg-primary text-white py-3 rounded-full font-semibold text-lg hover:bg-primary-dark transition-colors flex items-center justify-center gap-2 mt-4">
                                <span>Verificar</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Etapa de Dados Pessoais (oculto inicialmente) -->
                    <div class="user-details-step hidden mt-6">
                        <h3 class="text-xl font-semibold text-center mb-6">Complete seu perfil</h3>
                        
                        <!-- Foto de Perfil -->
                        <div class="mb-6">
                            <p class="mb-2 text-gray-700 text-center">Foto de Perfil</p>
                            <div class="flex flex-col items-center justify-center">
                                <div class="relative">
                                    <div id="profile-preview" class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mb-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                        </svg>
                                    </div>
                                    <input type="file" id="profile-photo" class="hidden" accept="image/*">
                                    <button id="upload-photo-btn" class="mt-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium flex items-center justify-center w-full">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="mr-2" viewBox="0 0 256 256">
                                            <path d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56Zm8,136a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H80a8,8,0,0,0,6.66-3.56L100.28,48h55.43l13.63,20.44A8,8,0,0,0,176,72h32a8,8,0,0,1,8,8ZM128,88a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,88Zm0,72a28,28,0,1,1,28-28A28,28,0,0,1,128,160Z"></path>
                                        </svg>
                                        <span>Escolher Foto</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Primeiro Nome -->
                        <div class="relative mb-4">
                            <input type="text" id="first-name" placeholder="Primeiro Nome" required
                                class="w-full py-4 pl-12 pr-4 border border-gray-300 rounded-full focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none text-base transition-all">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                    <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM74.08,197.5a64,64,0,0,1,107.84,0,87.83,87.83,0,0,1-107.84,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.76,66.41a79.66,79.66,0,0,0-36.06-28.75,48,48,0,1,0-59.4,0,79.66,79.66,0,0,0-36.06,28.75,88,88,0,1,1,131.52,0Z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <!-- Sobrenome -->
                        <div class="relative mb-4">
                            <input type="text" id="last-name" placeholder="Sobrenome" required
                                class="w-full py-4 pl-12 pr-4 border border-gray-300 rounded-full focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none text-base transition-all">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                    <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM74.08,197.5a64,64,0,0,1,107.84,0,87.83,87.83,0,0,1-107.84,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.76,66.41a79.66,79.66,0,0,0-36.06-28.75,48,48,0,1,0-59.4,0,79.66,79.66,0,0,0-36.06,28.75,88,88,0,1,1,131.52,0Z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <!-- Cidade -->
                        <div class="relative mb-4">
                            <select id="city" required
                                class="w-full py-4 pl-12 pr-4 border border-gray-300 rounded-full focus:border-primary focus:ring-2 focus:ring-primary-light focus:outline-none text-base transition-all">
                                <option value="">Selecione uma cidade</option>
                                <!-- As opções serão carregadas via JavaScript -->
                            </select>
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
                                    <path d="M128,16a88.1,88.1,0,0,0-88,88c0,75.3,80,132.17,83.41,134.55a8,8,0,0,0,9.18,0C136,236.17,216,179.3,216,104A88.1,88.1,0,0,0,128,16Zm0,56a32,32,0,1,1-32,32A32,32,0,0,1,128,72Z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <!-- Sexo -->
                        <div class="mb-4">
                            <p class="mb-2 text-gray-700 pl-2">Sexo</p>
                            <div class="grid grid-cols-3 gap-4">
                                <label class="flex items-center justify-center p-3 h-12 border border-gray-300 rounded-xl cursor-pointer hover:border-primary hover:bg-primary-light transition-all">
                                    <input type="radio" name="gender" value="M" class="mr-2">
                                    <span>Masculino</span>
                                </label>
                                <label class="flex items-center justify-center p-3 h-12 border border-gray-300 rounded-xl cursor-pointer hover:border-primary hover:bg-primary-light transition-all">
                                    <input type="radio" name="gender" value="F" class="mr-2">
                                    <span>Feminino</span>
                                </label>
                                <label class="flex items-center justify-center p-3 h-12 border border-gray-300 rounded-xl cursor-pointer hover:border-primary hover:bg-primary-light transition-all">
                                    <input type="radio" name="gender" value="O" class="mr-2">
                                    <span>Outro</span>
                                </label>
                            </div>
                        </div>
                        
                        <button id="register-submit" class="w-full h-12 bg-primary text-white py-3 rounded-full font-semibold text-lg hover:bg-primary-dark transition-colors flex items-center justify-center gap-2 mt-4">
                            <span>Concluir Cadastro</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Component -->
    <div id="toast" class="fixed top-4 right-4 z-[9999] hidden animate-fade-in">
        <div class="px-4 py-2 rounded-lg shadow-lg text-white font-medium"></div>
    </div>

    <script type="module">
        try {
            // Inicialização do cliente Supabase usando a configuração padronizada
            const supabase = window.createSupabaseClient();
            
            // Resto do código que usa o supabase
            // Continua com o código existente...
            
            // Verificar login existente
            const sessaoAtiva = verificarSessao();
            if (sessaoAtiva) {
                console.log('Sessão ativa detectada:', sessaoAtiva);
                redirecionarUsuario(sessaoAtiva.tipo);
            }
            
            // Adicionar event listeners após o DOM estar carregado
            document.addEventListener('DOMContentLoaded', setupEventListeners);
            
            /**
             * Verifica a sessão existente
             */
            function verificarSessao() {
                const session = localStorage.getItem('user_session');
                if (!session) return null;
                
                try {
                    const userData = JSON.parse(session);
                    return userData;
                } catch (e) {
                    console.error('Erro ao processar sessão:', e);
                    return null;
                }
            }
            
            /**
             * Redireciona o usuário com base no tipo
             */
            function redirecionarUsuario(tipo) {
                switch(tipo) {
                    case 'RESPONSÁVEL':
                        window.location.href = '/responsavel/home_respo.html';
                        break;
                    case 'NUTRICIONISTA':
                        window.location.href = '/nutricionista/home_nutri.html';
                        break;
                    case 'GESTOR':
                        window.location.href = '/gestor/home_gestor.html';
                        break;
                    case 'PROFISSIONAL':
                        window.location.href = '/profissional/home_profi.html';
                        break;
                    case 'ADMIN':
                        window.location.href = '/admin/dashboard.html';
                        break;
                    default:
                        // Para qualquer outro tipo não reconhecido
                        window.location.href = '/dashboard.html';
                }
            }
            
            // Configuração de todos os event listeners
            function setupEventListeners() {
                // Código existente para configurar os event listeners
                // (Mantenha o código existente que configura os event listeners)
            }
            
        } catch (error) {
            console.error('Erro ao inicializar o Supabase:', error);
        }
    </script>
</body>
</html> 